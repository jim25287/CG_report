---
title: "Cofit x Genesis 醫療大數據 (分析報告)"
author: "By Po-Lin Lin, BigData Team"
date: "Last Updated On `r Sys.Date()`"
knit: "bookdown::render_book"
site: bookdown::bookdown_site
documentclass: book
output:
  bookdown::gitbook:
    dev: svglite
    css: css/style.css
    includes:
      in_header: GA_script.html
      after_body: string_rm.html
    split_by: section
    number_sections: true
    toc_depth: 4
    self_contained: false
    config:
      toc:
        # before: |
        # <li><a href="https://jim25287.github.io/CG_report/">初日診所Genesis x 醫療大數據</a></li>
        collapse: subsection
      download: null
      edit: null
      sharing: null
      search: yes
  bookdown::html_chapters:
    css: [css/style.css, css/toc.css]
  bookdown::pdf_book:
    pandoc_args: --top-level-division=chapter
    toc_depth: 3
    toc_unnumbered: no
    toc_appendix: yes
    quote_footer: ["\\VA{", "}{}"]
  bookdown::epub_book:
    dev: svglite
    stylesheet: css/style.css
---

```{r setup, include=FALSE}
library(googleVis)
Sys.setenv(R_BENCHMARK=TRUE)
knitr::opts_chunk$set(echo = FALSE, comment = NA, results = 'asis', warning = FALSE, error = FALSE, message = FALSE, fig.align = 'center')
options(knitr.graphics.auto_pdf = TRUE, gvis.plot.tag = 'chart')
# options(knitr.graphics.auto_pdf = TRUE, gvis.plot.tag = NULL)
```

```{r input df from PostgreSQL, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/lin_function.R")
# 
# # Does source() rscript need to move to the same project dir??
# lin_connect_db("connect")
# path_sql <- "~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/sql/"
# 
# tmp_01 <- DBI::dbGetQuery(db, readr::read_file(paste0(path_sql, "01_profile.sql")))
# # tmp_01 <- DBI::dbGetQuery(db, readr::read_file(paste0(path_sql, "01_profile_flc_q.sql")))
# tmp_02 <- DBI::dbGetQuery(db, readr::read_file(paste0(path_sql, "02_inbody.sql")))
# tmp_03 <- DBI::dbGetQuery(db, readr::read_file(paste0(path_sql, "03_FLC_self_report.sql")))
# tmp_04 <- DBI::dbGetQuery(db, readr::read_file(paste0(path_sql, "04_non_FLC_self_report.sql")))
# tmp_05 <- DBI::dbGetQuery(db, readr::read_file(paste0(path_sql, "05_biochem.sql")))
# 
# tmp_06 <- DBI::dbGetQuery(db, readr::read_file(paste0(path_sql, "06_Diet_day.sql")))
# tmp_07 <- DBI::dbGetQuery(db, readr::read_file(paste0(path_sql, "07_Diet_meal.sql")))
# tmp_08 <- DBI::dbGetQuery(db, readr::read_file(paste0(path_sql, "08_3D_scanner.sql")))
# tmp_09 <- DBI::dbGetQuery(db, readr::read_file(paste0(path_sql, "09_hormone.sql")))
# tmp_03_day <- DBI::dbGetQuery(db, readr::read_file(paste0(path_sql, "10_daily_flc.sql")))
# lin_connect_db("exit")
# rm(path_sql)
# 
# tmp_03[tmp_03 %>% select_if(is.numeric) %>% select_if(~ !is.integer(.)) %>% names()]  %<>% lapply(as.numeric)
# 
# tmp_06[c("note_counts","pic_counts","essay_count","light_green_count","light_yellow_count","light_red_count","carbohydrate","protein","fat","calorie","grains_target","fruits_target","vegetables_target","meat_beans_low_fat_target","meat_beans_medium_fat_target","meat_beans_high_fat_target","milk_whole_fat_target","milk_low_fat_target","milk_skim_target","oil_target")] %<>% lapply(as.numeric)

  
```

```{r alternative try I: input workspace, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}

load("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/WSpace_preproc.RData")


#Load packages
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/lin_function.R")

library(pacman)
pacman::p_load(magrittr, knitr, kableExtra, dplyr, readr, readxl, tibble, showtext, extraInserts, ggvenn, ggplot2,knitr, kableExtra, openxlsx, lubridate, cowplot, ggpubr, webshot, stringr, googleVis)
#font
font_add(family = "berlin_default", regular = "~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/data/font/STHeiti Light.ttc")
showtext_auto(enable = TRUE)


```

```{r input plot rscript, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/00-data_preprocessing.R")

source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/00-main_page_stat.R")

source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/00_vars_vector.R")
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/01.1-venns.R")

```

```{r input plot rscript_global, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
#   使用者     系統     流逝 
# 2239.010   26.456 2268.609 

source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/01.2-global_treatment.R")
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/01.2.1-global_exclude_record_factor.R")



```

```{r input plot rscript_test, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# 使用者   系統   流逝 
# 42.664  0.705 43.546 
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/07-MHO.R")

source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/01.3-testosterone_effectiveness.R")

```

```{r input plot rscript_girc, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
#  使用者    系統    流逝 
# 230.912   3.230 234.972
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/02.girc.R")

```

```{r input plot rscript_sua, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
#  使用者    系統    流逝 
# 295.218   3.983 299.993 
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/03.sua_0.R")

#  使用者    系統    流逝 
# 319.686   4.806 326.727 
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/03.sua.R")

```

```{r input plot rscript_flc, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# 使用者   系統   流逝 
# 30.482  0.672 31.304 
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/04.cofit_flc.R")
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/05.urine_ketone.R")
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/06.prediction.R")
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/91.publication.R")
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/improvement_2_4_6mo.R")


```

# Highlight {#index .unnumbered}

**1.初日體系診所(秀傳、初日、小宙)累積客戶統計：**

```{r, results='asis', fig.width = 6}
client_monthly_stat_report %>% plot()
```

**#＃總計「累積服務客戶數」:** [**`r client_monthly_stat_report_total_id`**]{.underline}**(位)** / 累計共 [`r client_monthly_stat_report_total_client`]{.underline} (人次)

**2.初日減重門診 - 單次療程**(分析人數: `r success_df_freq[["Total"]] %>% max()`)：

-   [**成功減重人數(%)**]{.underline}，總計`r success_df_freq[success_df_freq$gender == "Total", "success"]`人(成功率:[**`r success_df_pct[success_df_freq$gender == "Total", "success"]`**]{.underline})。
-   [**女性:**]{.underline}`r success_df_freq[success_df_freq$gender == "female", "success"]`人(成功率:[**`r success_df_pct[success_df_freq$gender == "female", "success"]`**]{.underline})。
-   [**男性:**]{.underline}`r success_df_freq[success_df_freq$gender == "male", "success"]`人(成功率:[**`r success_df_pct[success_df_freq$gender == "male", "success"]`**]{.underline})。

```{r, results='asis'}
gvisMerge(plot_stack_col_female,plot_stack_col_male, horizontal = TRUE,
          tableOptions = "cellspacing=\"5\" bgcolor=\"#AABBCC\"") %>% plot()

```

<!-- Introduction context...(editing) -->

<!-- #### Disclaimer {.unnumbered} -->

<!-- The information in this report is provided ...(editing). -->

版本更新：

[更新]

-   2023-04-27
    1.  尿酮體 x 空腹胰島素分析(分群:介入前後Ketone變化)([Link](#ketone_response))
    2.  單因子預測力&切點分析(篩選:飲食紀律佳)([Link](#predict_cutoff_roc_filtered))

[新增]

-   2023-04-27
    1.  體重成效分層分析(篩選:飲食紀律佳)([Link](#strat_1_ob_filtered))
-   2023-04-20
    1.  單因子預測力&切點分析([Link](#predict_cutoff_roc))
-   2023-04-19
    1.  全變數 - Pearson Correlation Table([Link](#cor_ob_var_all))
    2.  尿酮體 x 空腹胰島素分析([Link](#ketone_response))

[(識別碼：`r lin_timestamp()`)]{style="float:right"}

<!--chapter:end:index.Rmd-->

# 減重成效 - (單次療程)

本節主要分析與探討「首次減重方案：在初始狀態(baseline)和飲食紀律(diet discipline)下的成效」。

在各小節中，將逐一說明如何針對「減重方案」數據源進行資料清洗，並運用清洗後數據，篩選出最終導入分析之「資料集」(dataset)，進行「減重成效」的資料探勘、分析與解讀，並描繪出初日診所(Genesis)減重策略下的成效輪廓。

同時，此次分析將聚焦「初始狀態」、「飲食紀律」對於減重成效的影響，作為未來幫助客戶達到最佳成效的依據與利器。

## 資料集(Datasets) {#vens_grap_ob}

```{r}
plot_venn_0
cat("\n<br>")
cat(" 減重門診客戶:", stat_table[stat_table[["client_type"]] == 2, "id"] %>% unique() %>% length(), "位 \n<br>",
    "控糖門診客戶:", stat_table[stat_table[["client_type"]] == 1, "id"] %>% unique() %>% length(), "位 \n<br>")
```

**納入標準:**

1.  首次方案：減重療程
2.  包含「體組成」(Inbody)、「血檢報告」及「飲食紀錄」等數據資料
3.  前、後測時間點誤差均在合理範圍(體組成±7days, 血檢±15days)
4.  有完整初始狀態OGTT血檢報告
5.  各項變數均無遺漏值(missing value)

```{r}
plot_venn_2
cat("\n<br>")
cat(" 總共:", stat_table[stat_table[["client_type"]] == 2, "id"] %>% unique() %>% length() ,"筆 \n<br>",
    "排除:", (stat_table[stat_table[["client_type"]] == 2, "id"] %>% unique() %>% length()) - (Reduce(intersect, list(stat_table[stat_table[["client_type"]] == 2, "id"],
                       stat_table[((!is.na(stat_table[["weight_baseline"]])) & (!is.na(stat_table[["weight_endpoint"]]))), "id"],
                       stat_table[((!is.na(stat_table[["glucose_ac_baseline"]])) & (!is.na(stat_table[["glucose_ac_endpoint"]]))), "id"],
                       stat_table[!is.na(stat_table[["note_count"]]), "id"])) %>% length()) , "筆 \n<br>",
    "納入分析:", Reduce(intersect, list(stat_table[stat_table[["client_type"]] == 2, "id"],
                       stat_table[((!is.na(stat_table[["weight_baseline"]])) & (!is.na(stat_table[["weight_endpoint"]]))), "id"],
                       stat_table[((!is.na(stat_table[["glucose_ac_baseline"]])) & (!is.na(stat_table[["glucose_ac_endpoint"]]))), "id"],
                       stat_table[!is.na(stat_table[["note_count"]]), "id"])) %>% length(), "筆 \n<br>")
```

## 客戶輪廓分析 {#porfile_ob}

**Subjects Distribution:** 年齡(Age) & 性別(Gender)分佈

```{r, results='asis'}
gvisMerge(pie_01, pie_02, horizontal = TRUE,
          tableOptions = "cellspacing=\"5\" bgcolor=\"#AABBCC\"") %>% plot()
```

**Subjects Distribution:** 身體質量指數(BMI)分佈

```{r, results='asis'}
gvisMerge(pie_03, pie_04, horizontal = TRUE,
          tableOptions = "cellspacing=\"5\" bgcolor=\"#AABBCC\"") %>% plot()

```

```{r, results='asis'}
gvisMerge(pie_03_2, pie_04_2, horizontal = TRUE,
          tableOptions = "cellspacing=\"5\" bgcolor=\"#AABBCC\"") %>% plot()

```

**Subjects Distribution:** 肥胖相關慢性共病

```{r, results='asis'}
pie_05_MetX %>% plot()

gvisMerge(gvisMerge(pie_05_DM, pie_05_Ins, horizontal = TRUE),
          gvisMerge(pie_05_HTN, pie_05_HLP,horizontal = TRUE),
          tableOptions = "cellspacing=\"5\" bgcolor=\"#AABBCC\"") %>% plot()

```




## 整體成效分析 {#global_result_ob}

**減重成效(各區間百分比%):**

減重部分：

在女性客戶中，高達98%在療程中實現減重目的(目標設定不同)。其中將近35％表現優異(降幅\>8%)，47%表現良好(降幅4\~8%)。

在男性客戶中，100%在療程中實現減重目的(目標設定不同)。其中將近1％表現超乎預期(降幅\>15%)、40％表現優異(降幅\>8%)，45%表現良好(降幅4\~8%)。

減脂部分：

在女性客戶中，高達97%在療程中實現減脂目的(目標設定不同)。其中將近27％表現超乎預期(降幅\>15%)，46%表現優異(降幅\>8%)，16%表現良好(降幅4\~8%)。

在男性客戶中，高達97%在療程中實現減脂目的(目標設定不同)。其中將近52％表現超乎預期(降幅\>15%)，29%表現優異(降幅\>8%)，11%表現良好(降幅4\~8%)。

```{r, results='asis'}
gvisMerge(plot_stack_col_female,plot_stack_col_male, horizontal = TRUE,
          tableOptions = "cellspacing=\"5\" bgcolor=\"#AABBCC\"") %>% plot()
```

-   Weight: 體重降幅(%)
-   Fat: 脂肪降幅(%)
-   Muscle: 肌肉降幅(%)

**體組成及血生化值成效(%):**

```{r, results='asis', fig.width = 7, fig.height= 7.5}
line_plot
```

## 相關分析(Correlation Analysis) {#cor_ob}
### 特定變數 {#cor_ob_var_specific .unnumbered}

**飲食紀錄(diet) x 成效**

減重表現與「飲食紀律」呈現顯著正相關。(飲食紀錄完成度、綠燈率、三大營養素攝取比例、六大類食物攝取量等)。

-   **「飲食紀錄完成度」與飲食紀律有關**：

    -   「飲食紀錄完成度」與「綠燈率」、「平均攝取熱量」、「蛋白質、脂肪攝取率」、「蔬菜、蛋豆魚肉、油脂攝取量」呈現正相關。

    -   與「黃、紅燈率」、「碳水化合物攝取率」呈負相關。

    -   六大類食物攝取量：

        -   「蔬菜」、「蛋豆魚肉」、「油脂」與減重成效呈現正相關；且這三類食物彼此呈現正相關。

        -   「水果」、「五穀雜糧」與減重成效成負相關。

```{r, results='asis', fig.width = 13, fig.height= 14, warning=FALSE}
corrplot::corrplot(M1, p.mat = M_test1$p,
         type = "lower",
         insig = "label_sig",
         sig.level = c(.001, .01, .05), pch.cex = .8, pch.col = "black",
         tl.col = "black", tl.srt = 35, tl.cex = 1.0,
         cl.ratio = 0.1,
         col = M_col(200),
         title = "[Correlation] Efficacy x Diet", 
         #c(bottom, left, top, right)
         mar = c(0,0,1,0))
         

```

```{r, results='asis', warning=FALSE}
knitr::kable(
  cor_table_01 %>% plot(), caption = 'Correlation: Diet and Effectiveness',
  booktabs = TRUE
)

```

**初始狀態(baseline) x 成效**

減重表現與初始狀態沒有顯著相關；「減脂」表現但BMI、體脂率、腰圍、空腹胰島素、HOMA-IR等初始狀態呈現負相關(i.e., 越胖的人減脂%較低)，可能是因為體脂初始值較高，而導致降幅%變小所致。

此外，根據1.2.2 整體成效分析，體脂肪降幅相較體重降幅明顯，顯示不論初始狀態如何，每一個人在單次療程中減少去的體脂重「可能」差不多(待進一步分析)。

```{r, results='asis', fig.width = 9, fig.height= 9.5, warning=FALSE}
corrplot::corrplot(M2, 
         p.mat = M_test2$p,
         type = "lower",
         insig = "label_sig",
         sig.level = c(.001, .01, .05), pch.cex = .8, pch.col = "black",
         tl.col = "black", tl.srt = 35, tl.cex = 1.0,
         cl.ratio = 0.1,
         col = M_col(200),
         title = "[Correlation] Efficacy x Baseline",
         #c(bottom, left, top, right)
         mar = c(0,0,1,0)) 
```

```{r, results='asis', warning=FALSE}
knitr::kable(
  cor_table_02 %>% plot(), caption = 'Correlation: Diet and Baseline',
  booktabs = TRUE
)
```

### 全變數 {#cor_ob_var_all .unnumbered}
**Global Correlation Table**

```{r, results='asis', warning=FALSE}
cor_table_all_01
```


<!--chapter:end:01-single_treatment_efficacy.Rmd-->

## 分層分析-1: 減重成效 {#strat_1_ob}

**依據減重成效進行分層分析，分成三個組別：**

-   **成效「優異」: (減重\>10%)**
-   **「良好」: (減重介於 5 \~ 10%)**
-   **「低於預期」: (減重\< 3%)**

```{r  paged.print=TRUE}
table_01
```

### 初始狀態(Baseline) {#baseline_ob .unnumbered}

[在目前的初日診所減重客群中]{.underline}，我們的控糖減重策略成效跟「介入前狀態」 (包括年齡、性別、BMI、體脂率、糖化血色素、空腹血糖、胰島素值等) 無顯著相關。

#### Inbody {#baseline_ob_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t0_1")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(1,100)))
```

#### 相位角 {#baseline_ob_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t0_2")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#baseline_ob_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t0_3")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#baseline_ob_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t0_4")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#baseline_ob_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t0_5")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#baseline_ob_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t0_6")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#baseline_ob_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t0_7")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#baseline_ob_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t0_8")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#baseline_ob_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t0_9")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#baseline_ob_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t0_10")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global[["block"]] == "t0_10") %>% min(),1000)))
```

### 介入後狀態(Endpoint) {#endpoint_ob .unnumbered}

#### Inbody {#endpoint_ob_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t1_1")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(1,100)))
```

#### 相位角 {#endpoint_ob_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t1_2")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#endpoint_ob_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t1_3")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#endpoint_ob_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t1_4")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#endpoint_ob_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t1_5")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#endpoint_ob_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t1_6")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#endpoint_ob_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t1_7")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#endpoint_ob_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t1_8")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#endpoint_ob_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t1_9")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#endpoint_ob_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "t1_10")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global[["block"]] == "t0_10") %>% min(),1000)))
```

### 飲食(Diet) {#diet_ob .unnumbered}

在分層分析中顯示，減重表現優異者在飲食紀錄完成度、綠燈率、三大營養素攝取比例、六大類食物攝取量等均優於減重表現低於預期者，具統計上顯著差異。

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "diet") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "diet")],
          ncol = 2,
          labels = paste0(LETTERS[5], seq(1,100)))
```

### ∆成效(Effectiveness) {#delta_ob .unnumbered}

#### Inbody {#delta_ob_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_1")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(1,100)))
```

#### 相位角 {#delta_ob_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_2")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#delta_ob_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_3")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#delta_ob_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_4")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#delta_ob_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_5")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#delta_ob_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_6")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#delta_ob_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_7")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#delta_ob_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_8")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#delta_ob_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_9")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#delta_ob_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_10")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global[["block"]] == "t0_10") %>% min(),1000)))
```

### ∆成效(%)(Effectiveness) {#delta_p_ob .unnumbered}

#### Inbody {#delta_p_ob_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_p_1")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(1,100)))
```

#### 相位角 {#delta_p_ob_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_p_2")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#delta_p_ob_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_p_3")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#delta_p_ob_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_p_4")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#delta_p_ob_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_p_5")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#delta_p_ob_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_p_6")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#delta_p_ob_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_p_7")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#delta_p_ob_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_p_8")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#delta_p_ob_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_p_9")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#delta_p_ob_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots[which(myplot_table_global[["block"]] == "delta_p_10")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global[["block"]] == "t0_10") %>% min(),1000)))
```

### Summary {#Summary_ob .unnumbered}

在我們的客群中：

1.  **成效**：在體重(脂)、內臟脂肪、腰圍、糖化血色素、空腹血糖(胰島素)、胰島阻抗值等，均呈現具有[**顯著改善**]{.underline}趨勢。

2.  控糖減重策略的「成效」跟[**「介入前狀態」(Baseline)無關**]{.underline}。

3.  減重「成效」與[**「飲食紀律」(Obedience)有關**]{.underline}(例如：飲食紀錄完成率、上傳照片數、綠燈率等)，且具有統計上顯著差異。

```{r, results='asis',  paged.print=TRUE}
table_02
```

<!--chapter:end:01.1-global.Rmd-->

## 續(篩選飲食上傳>80%) {#strat_1_ob_filtered}

**依據減重成效進行分層分析，分成三個組別：**

-   **成效「優異」: (減重\>10%)**
-   **「良好」: (減重介於 5 \~ 10%)**
-   **「低於預期」: (減重\< 3%)**

```{r  paged.print=TRUE}
table_01_exclude_record_factor
```

### 初始狀態(Baseline) {#baseline_ob_filtered .unnumbered}



#### Inbody {#baseline_ob_filtered_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t0_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t0_1")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(1,100)))
```

#### 相位角 {#baseline_ob_filtered_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t0_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t0_2")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global_filter[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#baseline_ob_filtered_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t0_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t0_3")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global_filter[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#baseline_ob_filtered_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t0_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t0_4")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global_filter[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#baseline_ob_filtered_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t0_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t0_5")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global_filter[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#baseline_ob_filtered_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t0_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t0_6")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global_filter[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#baseline_ob_filtered_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t0_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t0_7")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global_filter[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#baseline_ob_filtered_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t0_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t0_8")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global_filter[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#baseline_ob_filtered_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t0_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t0_9")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global_filter[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#baseline_ob_filtered_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t0_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t0_10")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global_filter[["block"]] == "t0_10") %>% min(),1000)))
```

### 介入後狀態(Endpoint) {#endpoint_ob_filtered .unnumbered}

#### Inbody {#endpoint_ob_filtered_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t1_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t1_1")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(1,100)))
```

#### 相位角 {#endpoint_ob_filtered_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t1_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t1_2")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global_filter[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#endpoint_ob_filtered_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t1_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t1_3")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global_filter[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#endpoint_ob_filtered_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t1_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t1_4")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global_filter[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#endpoint_ob_filtered_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t1_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t1_5")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global_filter[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#endpoint_ob_filtered_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t1_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t1_6")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global_filter[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#endpoint_ob_filtered_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t1_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t1_7")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global_filter[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#endpoint_ob_filtered_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t1_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t1_8")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global_filter[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#endpoint_ob_filtered_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t1_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t1_9")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global_filter[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#endpoint_ob_filtered_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "t1_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "t1_10")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global_filter[["block"]] == "t0_10") %>% min(),1000)))
```

### 飲食(Diet) {#diet_ob_filtered .unnumbered}



```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "diet") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "diet")],
          ncol = 2,
          labels = paste0(LETTERS[5], seq(1,100)))
```

### ∆成效(Effectiveness) {#delta_ob_filtered .unnumbered}

#### Inbody {#delta_ob_filtered_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_1")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(1,100)))
```

#### 相位角 {#delta_ob_filtered_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_2")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global_filter[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#delta_ob_filtered_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_3")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global_filter[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#delta_ob_filtered_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_4")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global_filter[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#delta_ob_filtered_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_5")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global_filter[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#delta_ob_filtered_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_6")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global_filter[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#delta_ob_filtered_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_7")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global_filter[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#delta_ob_filtered_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_8")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global_filter[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#delta_ob_filtered_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_9")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global_filter[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#delta_ob_filtered_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_10")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global_filter[["block"]] == "t0_10") %>% min(),1000)))
```

### ∆成效(%)(Effectiveness) {#delta_p_ob_filtered .unnumbered}

#### Inbody {#delta_p_ob_filtered_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_p_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_p_1")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(1,100)))
```

#### 相位角 {#delta_p_ob_filtered_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_p_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_p_2")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global_filter[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#delta_p_ob_filtered_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_p_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_p_3")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global_filter[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#delta_p_ob_filtered_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_p_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_p_4")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global_filter[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#delta_p_ob_filtered_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_p_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_p_5")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global_filter[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#delta_p_ob_filtered_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_p_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_p_6")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global_filter[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#delta_p_ob_filtered_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_p_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_p_7")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global_filter[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#delta_p_ob_filtered_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_p_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_p_8")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global_filter[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#delta_p_ob_filtered_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_p_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_p_9")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global_filter[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#delta_p_ob_filtered_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global_filter[["block"]] == "delta_p_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_exclude_record_factor[which(myplot_table_global_filter[["block"]] == "delta_p_10")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global_filter[["block"]] == "t0_10") %>% min(),1000)))
```

### Summary {#Summary_ob_filtered .unnumbered}



```{r, results='asis',  paged.print=TRUE}
table_02_exclude_record_factor
```

<!--chapter:end:01.2-global_filtered.Rmd-->

## 分層分析-2: 男性:睪固酮(Testosterone) {#strat_1_testosterone}

**依據睪固酮(Testosterone)初始狀態進行分層分析，分成二個組別：**

-   **睪固酮低下: (**小於 \<350 ng/dl)
-   **睪固酮正常: (**大於 \>350 ng/dl)

**男性睪固酮分組&年齡分佈**

```{r fig.align='left'}
googleVis::gvisMerge(pie_testosterone_01, pie_testosterone_02, horizontal = TRUE,
          tableOptions = "cellspacing=\"5\" bgcolor=\"#AABBCC\"") %>% plot()
```

### 相關分析(Correlation Analysis) {#cor_test_testosterone .unnumbered}

**睪固酮(Testosterone) x 初始狀態(Baseline)**

男性荷爾蒙「睪固酮」血中濃度與「體重」、「體脂」，以及「空腹血糖」、「空腹胰島素」和「胰島素抗性」(IR)具有顯著負相關。換句話說，相較於「睪固酮」濃度正常的人，[「睪固酮」低下]{.underline}者傾向有[較高的「體重」、「體脂」]{.underline}，[「空腹血糖」、「空腹胰島素」和「胰島素抗性」(IR)也較高]{.underline}。\

```{r, results='asis', fig.width = 9, fig.height= 9.5, warning=FALSE}
  corrplot::corrplot(M_testosterone,
           p.mat = M_testosterone_test$p,
           type = "lower",
           insig = "label_sig",
           sig.level = c(.001, .01, .05), pch.cex = .8, pch.col = "black",
           tl.col = "black", tl.srt = 35, tl.cex = 1.0,
           cl.ratio = 0.1,
           col = M_col(200),
           title = "[Correlation] Efficacy x Baseline",
           #c(bottom, left, top, right)
           mar = c(0,0,1,0))

```

```{r, results='asis', warning=FALSE}
knitr::kable(
  cor_table_testosterone %>% plot(), caption = 'Correlation: Testosterone and Effectiveness',
  booktabs = TRUE
) 
```

### 初始狀態(Baseline) {#baseline_testosterone .unnumbered}

#### Inbody {.unnumbered}

```{r, results='asis', fig.width= 12, fig.height=8}
plot_grid(plotlist = myplots_plot_testosterone[1:10], ncol = 5, labels = paste0(LETTERS[1], seq(1,50)))

```

#### Blood {.unnumbered}

```{r, results='asis', fig.width= 12, fig.height=8}
plot_grid(plotlist = myplots_plot_testosterone[11:20], ncol = 5, labels = paste0(LETTERS[2], seq(1,50)))
```

### 介入後狀態(Endpoint) {#endpoint_testosterone .unnumbered}

#### Inbody {.unnumbered}

```{r, results='asis', fig.width= 12, fig.height=8}
plot_grid(plotlist = myplots_plot_testosterone[21:30], ncol = 5, labels = paste0(LETTERS[3], seq(1,50)))
```

#### Blood {.unnumbered}

```{r, results='asis', fig.width= 12, fig.height=8}
plot_grid(plotlist = myplots_plot_testosterone[31:40], ncol = 5, labels = paste0(LETTERS[4], seq(1,50)))
```

### 飲食(Diet) {#diet_testosterone .unnumbered}

在分層分析中顯示，減重表現優異者在飲食紀錄完成度、綠燈率、三大營養素攝取比例、六大類食物攝取量等均優於減重表現低於預期者，具統計上顯著差異。

```{r, results='asis', fig.width= 12, fig.height=16}
plot_grid(plotlist = myplots_plot_testosterone[41:57], ncol = 5, labels = paste0(LETTERS[5], seq(1,50)))
```

### 成效(Effectiveness) {#effectiveness_testosterone .unnumbered}

#### 成效(∆)-Inbody {.unnumbered}

```{r, results='asis', fig.width= 12, fig.height=8}
plot_grid(plotlist = myplots_plot_testosterone[58:67], ncol = 5, labels = paste0(LETTERS[6], seq(1,50)))
```

#### 成效(∆)-Blood {.unnumbered}

```{r, results='asis', fig.width= 12, fig.height=8}
plot_grid(plotlist = myplots_plot_testosterone[68:77], ncol = 5, labels = paste0(LETTERS[7], seq(1,50)))
```

#### 成效(%)-Inbody {.unnumbered}

```{r, results='asis', fig.width= 12, fig.height=8}
plot_grid(plotlist = myplots_plot_testosterone[78:87], ncol = 5, labels = paste0(LETTERS[8], seq(1,50)))
```

#### 成效(%)-Blood {.unnumbered}

```{r, results='asis', fig.width= 12, fig.height=8}
plot_grid(plotlist = myplots_plot_testosterone[88:97], ncol = 5, labels = paste0(LETTERS[9], seq(1,50)))
```

```{r, results='asis', paged.print=TRUE}
table_02_testosterone
```

## 分層分析-3: 尿酸(Serum Uric Acid) {#strat_2_sua}

### 相關分析(Correlation Analysis) {#cor_sua}

```{r, results='asis',  paged.print=TRUE}
plot_SUA_01
plot_SUA_02
```

```{r, results='asis', fig.width = 12, fig.height= 8.5, warning=FALSE}
corrplot::corrplot(M1_sua,
         p.mat = M_test1_sua$p,
         type = "lower",
         insig = "label_sig",
         sig.level = c(.001, .01, .05), pch.cex = .8, pch.col = "black",
         tl.col = "black", tl.srt = 35, tl.cex = 1.0,
         cl.ratio = 0.1,
         col = M_col_sua(200),
         title = "[Correlation] Uric acid x Diet",
         #c(bottom, left, top, right)
         mar = c(0,0,1,0))
```

```{r, results='asis', warning=FALSE}
knitr::kable(
  cor_table_01_sua %>% plot(), caption = 'Correlation: Diet and Effectiveness',
  booktabs = TRUE
)

```

```{r, results='asis', fig.width = 12, fig.height= 8.5, warning=FALSE}
corrplot::corrplot(M2_sua,
         p.mat = M_test2_sua$p,
         type = "lower",
         insig = "label_sig",
         sig.level = c(.001, .01, .05), pch.cex = .8, pch.col = "black",
         tl.col = "black", tl.srt = 35, tl.cex = 1.0,
         cl.ratio = 0.1,
         col = M_col_sua(200),
         title = "[Correlation] Efficacy x Baseline",
         #c(bottom, left, top, right)
         mar = c(0,0,1,0))

```

```{r, results='asis', warning=FALSE}
knitr::kable(
  cor_table_02_sua %>% plot(), caption = 'Correlation: Diet and Effectiveness',
  booktabs = TRUE
)

```

### Cutoff-1 (♂7.6/♀6.6) {#cutoff_sua_2}

```{r, results='asis', paged.print=TRUE}
table_freq_sua_ob
```

### 初始狀態(Baseline) {#baseline_sua .unnumbered}

#### Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua[1:10], ncol = 2, labels = paste0(LETTERS[1], seq(1,50)))

```

#### Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=22}
plot_grid(plotlist = myplots_sua[11:22], ncol = 2, labels = paste0(LETTERS[2], seq(1,50)))
```

### 介入後狀態(Endpoint) {#endpoint_sua .unnumbered}

#### Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua[23:32], ncol = 2, labels = paste0(LETTERS[3], seq(1,50)))
```

#### Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua[33:44], ncol = 2, labels = paste0(LETTERS[4], seq(1,50)))
```

### 飲食(Diet) {#diet_sua .unnumbered}

```{r, results='asis', fig.width= 10, fig.height=44}
plot_grid(plotlist = myplots_sua[45:61], ncol = 2, labels = paste0(LETTERS[5], seq(1,50)))
```

### 成效(Effectiveness) {#effectiveness_sua .unnumbered}

#### 成效(∆)-Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua[62:71], ncol = 2, labels = paste0(LETTERS[6], seq(1,50)))
```

#### 成效(∆)-Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua[72:83], ncol = 2, labels = paste0(LETTERS[7], seq(1,50)))
```

#### 成效(%)-Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua[84:93], ncol = 2, labels = paste0(LETTERS[8], seq(1,50)))
```

#### 成效(%)-Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua[94:105], ncol = 2, labels = paste0(LETTERS[9], seq(1,50)))
```

```{r, results='asis', paged.print=TRUE}
table_02_sua
```

### Cutoff-2 (5.5) {#cutoff_sua_0}

```{r, results='asis', paged.print=TRUE}
table_freq_sua0_ob
```

### 初始狀態(Baseline) {#baseline_sua0 .unnumbered}

#### Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua0[1:10], ncol = 2, labels = paste0(LETTERS[1], seq(1,50)))

```

#### Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=22}
plot_grid(plotlist = myplots_sua0[11:22], ncol = 2, labels = paste0(LETTERS[2], seq(1,50)))
```

### 介入後狀態(Endpoint) {#endpoint_sua0 .unnumbered}

#### Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua0[23:32], ncol = 2, labels = paste0(LETTERS[3], seq(1,50)))
```

#### Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua0[33:44], ncol = 2, labels = paste0(LETTERS[4], seq(1,50)))
```

### 飲食(Diet) {#diet_sua0 .unnumbered}

```{r, results='asis', fig.width= 10, fig.height=44}
plot_grid(plotlist = myplots_sua0[45:61], ncol = 2, labels = paste0(LETTERS[5], seq(1,50)))
```

### 成效(Effectiveness) {#effectiveness_sua0 .unnumbered}

#### 成效(∆)-Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua0[62:71], ncol = 2, labels = paste0(LETTERS[6], seq(1,50)))
```

#### 成效(∆)-Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua0[72:83], ncol = 2, labels = paste0(LETTERS[7], seq(1,50)))
```

#### 成效(%)-Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua0[84:93], ncol = 2, labels = paste0(LETTERS[8], seq(1,50)))
```

#### 成效(%)-Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_sua0[94:105], ncol = 2, labels = paste0(LETTERS[9], seq(1,50)))
```

```{r, results='asis', paged.print=TRUE}
table_02_sua0
```

## 分層分析-4: Metabolically Healthy Obesity(MHO) {#strat_4_MHO}

Criteria:

1.  Obesity: BMI ≥30 kg/m^2^

2.  Fasted serum triglycerides: ≤150 mg/dl

3.  HDL cholesterol serum concentrations:

    1.  \>40 mg/dl (in men)

    2.  \>50 mg/dl (in women)

4.  Blood Pressure:

    1.  Systolic blood pressure (SBP) ≤130 mmHg

    2.  Diastolic blood pressure ≤85 mmHg

5.  Fasting blood glucose ≤100 mg/dl

    [Reference: Blüher M. Metabolically Healthy Obesity. Endocr Rev. 2020 May 1;41(3):bnaa004. doi: 10.1210/endrev/bnaa004. PMID: 32128581; PMCID: PMC7098708.]{.smallcaps}
    

```{r  paged.print=TRUE}
table_MHO_01
```

### 初始狀態(Baseline) {#baseline_MHO .unnumbered}

#### Inbody {#baseline_MHO_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t0_1")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(1,100)))
```

#### 相位角 {#baseline_MHO_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t0_2")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#baseline_MHO_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t0_3")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#baseline_MHO_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t0_4")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#baseline_MHO_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t0_5")],
          ncol = 2,
          labels = paste0(LETTERS[1], seq(which(myplot_table_global[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#baseline_MHO_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t0_6")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#baseline_MHO_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t0_7")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#baseline_MHO_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t0_8")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#baseline_MHO_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t0_9")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#baseline_MHO_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t0_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t0_10")],
          ncol = 2,
          labels = paste0(LETTERS[2], seq(which(myplot_table_global[["block"]] == "t0_10") %>% min(),1000)))
```

### 介入後狀態(Endpoint) {#endpoint_MHO .unnumbered}

#### Inbody {#endpoint_MHO_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t1_1")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(1,100)))
```

#### 相位角 {#endpoint_MHO_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t1_2")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#endpoint_MHO_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t1_3")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#endpoint_MHO_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t1_4")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#endpoint_MHO_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t1_5")],
          ncol = 2,
          labels = paste0(LETTERS[3], seq(which(myplot_table_global[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#endpoint_MHO_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t1_6")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#endpoint_MHO_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t1_7")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#endpoint_MHO_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t1_8")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#endpoint_MHO_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t1_9")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#endpoint_MHO_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "t1_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "t1_10")],
          ncol = 2,
          labels = paste0(LETTERS[4], seq(which(myplot_table_global[["block"]] == "t0_10") %>% min(),1000)))
```

### 飲食(Diet) {#diet_MHO .unnumbered}

在分層分析中顯示，減重表現優異者在飲食紀錄完成度、綠燈率、三大營養素攝取比例、六大類食物攝取量等均優於減重表現低於預期者，具統計上顯著差異。

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "diet") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "diet")],
          ncol = 2,
          labels = paste0(LETTERS[5], seq(1,100)))
```

### ∆成效(Effectiveness) {#delta_MHO .unnumbered}

#### Inbody {#delta_MHO_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_1")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(1,100)))
```

#### 相位角 {#delta_MHO_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_2")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#delta_MHO_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_3")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#delta_MHO_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_4")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#delta_MHO_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_5")],
          ncol = 2,
          labels = paste0(LETTERS[6], seq(which(myplot_table_global[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#delta_MHO_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_6")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#delta_MHO_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_7")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#delta_MHO_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_8")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#delta_MHO_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_9")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#delta_MHO_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_10")],
          ncol = 2,
          labels = paste0(LETTERS[7], seq(which(myplot_table_global[["block"]] == "t0_10") %>% min(),1000)))
```

### ∆成效(%)(Effectiveness) {#delta_p_MHO .unnumbered}

#### Inbody {#delta_p_MHO_inbody .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_1") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_p_1")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(1,100)))
```

#### 相位角 {#delta_p_MHO_wepa .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_2") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_p_2")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global[["block"]] == "t0_2") %>% min(),1000)))
```

#### 體水份 {#delta_p_MHO_water .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_3") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_p_3")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global[["block"]] == "t0_3") %>% min(),1000)))
```

#### inbody - 部位別 {#delta_p_MHO_inbody_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_4") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_p_4")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global[["block"]] == "t0_4") %>% min(),1000)))
```

#### 體水份 - 部位別 {#delta_p_MHO_water_part .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_5") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_p_5")],
          ncol = 2,
          labels = paste0(LETTERS[8], seq(which(myplot_table_global[["block"]] == "t0_5") %>% min(),1000)))
```

#### Glucose/Insulin {#delta_p_MHO_gi .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_6") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_p_6")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global[["block"]] == "t0_6") %>% min(),1000)))
```

#### Lipid {#delta_p_MHO_lipid .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_7") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_p_7")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global[["block"]] == "t0_7") %>% min(),1000)))
```

#### Kidney {#delta_p_MHO_kidney .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_8") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_p_8")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global[["block"]] == "t0_8") %>% min(),1000)))
```

#### Hormone {#delta_p_MHO_hormone .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_9") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_p_9")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global[["block"]] == "t0_9") %>% min(),1000)))
```

#### Hematology {#delta_p_MHO_hematology .unnumbered}

```{r, results='asis', fig.dim = c(5*2,4*(sum(myplot_table_global[["block"]] == "delta_p_10") %>% divide_by(2) %>% ceiling()))}
plot_grid(plotlist = myplots_MHO[which(myplot_table_global[["block"]] == "delta_p_10")],
          ncol = 2,
          labels = paste0(LETTERS[9], seq(which(myplot_table_global[["block"]] == "t0_10") %>% min(),1000)))
```

### Summary {#Summary_MHO .unnumbered}


```{r, results='asis',  paged.print=TRUE}
table_MHO_02
```




## 尿酮體 x 空腹胰島素 {#ketone_response}

### Chisq分析

#### Endpoint {.unnumbered}

Fasting Insulin Cutoff = 6

```{r, results='hold'}
lin_chisq.test(ketone_endpoint, ins_gp, urine_ketones_endpoint)


```

#### Baseline {.unnumbered}

```{r, results='hold'}
lin_chisq.test(ketone_baseline, ins_gp, urine_ketones_baseline)
```

#### Pooled {.unnumbered}

```{r, results='hold'}
lin_chisq.test(ketone_all, ins_gp, ketone)
```

### 敏感度分析

#### Endpoint {.unnumbered}

```{r}
plot_ketone_auc_table_endpoint
```

Fasting Insulin(Cutoff = 6)預測尿酮體反應(+)的Sensitivity= 0.42, Specificity= 0.81。

#### Baseline {.unnumbered}

```{r}
plot_ketone_auc_table_baseline
```

Fasting Insulin(Cutoff = 6)預測尿酮體反應(+)的Sensitivity= 0.32, Specificity= 0.85。

#### Pooled {.unnumbered}

```{r}
plot_ketone_auc_table_all
```

Fasting Insulin(Cutoff = 6)預測尿酮體反應(+)的Sensitivity= 0.40, Specificity= 0.84。

### Optimal Cutoff分析

#### Endpoint {.unnumbered}

```{r, fig.dim=c(10,8)}
plot_ketone_auc_endpoint
```

#### Baseline {.unnumbered}

```{r, fig.dim=c(10,8)}
plot_ketone_auc_baseline
```

#### Pooled {.unnumbered}

```{r, fig.dim=c(10,8)}
plot_ketone_auc_all
```

### 分層分析 {#strat_4_ketone_response}

```{r}
table_01_qqqq
```

#### 初始狀態(Baseline) {#baseline_kt .unnumbered}

##### Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_qqqq[1:10], ncol = 2, labels = paste0(LETTERS[1], seq(1,50)))

```

##### Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=22}
plot_grid(plotlist = myplots_qqqq[11:22], ncol = 2, labels = paste0(LETTERS[2], seq(1,50)))
```

#### 介入後狀態(Endpoint) {#endpoint_kt .unnumbered}

##### Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_qqqq[23:32], ncol = 2, labels = paste0(LETTERS[3], seq(1,50)))
```

##### Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_qqqq[33:44], ncol = 2, labels = paste0(LETTERS[4], seq(1,50)))
```

#### 飲食(Diet) {#diet_kt .unnumbered}

```{r, results='asis', fig.width= 10, fig.height=44}
plot_grid(plotlist = myplots_qqqq[45:61], ncol = 2, labels = paste0(LETTERS[5], seq(1,50)))
```

#### 成效(Effectiveness) {#effectiveness_kt .unnumbered}

##### 成效(∆)-Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_qqqq[62:71], ncol = 2, labels = paste0(LETTERS[6], seq(1,50)))
```

##### 成效(∆)-Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_qqqq[72:83], ncol = 2, labels = paste0(LETTERS[7], seq(1,50)))
```

##### 成效(%)-Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_qqqq[84:93], ncol = 2, labels = paste0(LETTERS[8], seq(1,50)))
```

##### 成效(%)-Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_qqqq[94:105], ncol = 2, labels = paste0(LETTERS[9], seq(1,50)))
```

##### Summary {.unnumbered}

```{r, results='asis', paged.print=TRUE}
table_02_qqqq
```

<!--chapter:end:01.3_stratss.Rmd-->

# Glucose Insulin Response Curve(GIRC)

```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/lin_function.R")
# source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/02.girc.R")

```

診斷標準：

![](https://raw.githubusercontent.com/jim25287/CG_report/main/image/girc_class.png){width="1200"}

Pattern分佈：

```{r}
plot_M[[1]]
plot_M[[2]]
```

```{r}
plot_m[[1]]
plot_m[[2]]
```

## OGTT胰島素反應分型

### Pattern I

![](https://raw.githubusercontent.com/jim25287/CG_report/main/image/girc_class.png){width="1200"}

```{r, out.width = "300px",fig.align='default', fig.nol=4}
url <- c("https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/1.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/2.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/3.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/4.jpg"
         )
knitr::include_graphics(url)

```

### Pattern II

![](https://raw.githubusercontent.com/jim25287/CG_report/main/image/girc_class.png){width="1200"}

```{r, out.width = "300px",fig.align='default', fig.nol=4}
url <- c("https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/5.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/6.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/7.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/8.jpg"
         )
knitr::include_graphics(url)

```

### Pattern III

![](https://raw.githubusercontent.com/jim25287/CG_report/main/image/girc_class.png){width="1200"}

```{r, out.width = "300px",fig.align='default', fig.nol=4}
url <- c("https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/9.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/10.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/11.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/12.jpg"
         )
knitr::include_graphics(url)

```

### Pattern IV

![](https://raw.githubusercontent.com/jim25287/CG_report/main/image/girc_class.png){width="1200"}

```{r, out.width = "300px",fig.align='default', fig.nol=5}
url <- c("https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/13.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/14.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/15.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/16.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/17.jpg"
         )
knitr::include_graphics(url)

```

### Pattern V

![](https://raw.githubusercontent.com/jim25287/CG_report/main/image/girc_class.png){width="1200"}

```{r, out.width = "300px",fig.align='default', fig.nol=2}
url <- c("https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/18.jpg",
         "https://raw.githubusercontent.com/jim25287/CG_report/main/image/00.auto_scale/19.jpg"
         )
knitr::include_graphics(url)

```

## GIRC分析 {#girc_analysis_}

### DM x GIRC分佈(All) {#girc_table_all .unnumbered}

```{r}
table_girc_all
table_DM_girc_all
table_Insulin_girc_all
```

### DM x GIRC分佈(Obesity Program) {#girc_table_ob .unnumbered}

```{r}
table_girc_ob
table_DM_girc_ob
table_Insulin_girc_ob
```

### GIRC分層分析 {.unnumbered}

### 初始狀態(Baseline) {#baseline_girc .unnumbered}

#### Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_girc[1:10], ncol = 2, labels = paste0(LETTERS[1], seq(1,50)))

```

#### Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=22}
plot_grid(plotlist = myplots_girc[11:22], ncol = 2, labels = paste0(LETTERS[2], seq(1,50)))
```

### 介入後狀態(Endpoint) {#endpoint_girc .unnumbered}

#### Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_girc[23:32], ncol = 2, labels = paste0(LETTERS[3], seq(1,50)))
```

#### Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_girc[33:44], ncol = 2, labels = paste0(LETTERS[4], seq(1,50)))
```

### 飲食(Diet) {#diet_girc .unnumbered}

```{r, results='asis', fig.width= 10, fig.height=44}
plot_grid(plotlist = myplots_girc[45:61], ncol = 2, labels = paste0(LETTERS[5], seq(1,50)))
```

### 成效(Effectiveness) {#effectiveness_girc .unnumbered}

#### 成效(∆)-Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_girc[62:71], ncol = 2, labels = paste0(LETTERS[6], seq(1,50)))
```

#### 成效(∆)-Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_girc[72:83], ncol = 2, labels = paste0(LETTERS[7], seq(1,50)))
```

#### 成效(%)-Inbody {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_girc[84:93], ncol = 2, labels = paste0(LETTERS[8], seq(1,50)))
```

#### 成效(%)-Blood {.unnumbered}

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots_girc[94:105], ncol = 2, labels = paste0(LETTERS[9], seq(1,50)))
```

```{r, results='asis', paged.print=TRUE}
table_02_girc
```

### Pattern改善分析 {#girc_improvemnt_path .unnumbered}

```{r}
table_improvement_girc_all
```

<!--chapter:end:02-insulin_ogtt_curve.Rmd-->

# Prediction(研究中)

## 單因子預測力&切點分析 {#predict_cutoff_roc}
```{r}
table_global_cutoff
```

## 單因子預測力&切點分析(排除飲食紀律不佳) {#predict_cutoff_roc_filtered}
```{r}
table_global_cutoff_exclude_record_factor
```


<!--chapter:end:03-Prediction.Rmd-->

# Publication(1)

## Genesis Insulin Response Pattern {#p1-1}

### Figure 1. Genesis Pattern Categorization {#p1-1fig1}

![](https://raw.githubusercontent.com/jim25287/CG_report/main/image/girc_class_major.png){width="60%"}

### Figure 2. Genesis Pattern Distribution. {#p1-1fig2}

```{r}
pub1_plot_M[[2]] 
pub1_plot_M[[1]]
```

## Genesis Insulin Response Pattern Model for early IR/Obesity diagnosis {#p1-2}

### Table 1. Genesis Pattern Distribution Characteristics. {#p1-2tab1}

```{r}
Pub1_stat_table_1st_tbl1


```

### Figure 3. Body Composition & Biochem. Profile. {#p1-2fig3}

```{r, results='asis', fig.width= 10, fig.height=24}
cowplot::plot_grid(plotlist = myplots_pub1[c(12,1:3, 4:7, 8:11)], ncol = 2)


```

### Figure 4,5. Genesis Pattern is a Potential Tool of early IR(Obesity) diagnosis {#p1-2fig45}

```{r}
#x-axis: DM(BMI), y-axis: stack gp(IR, Pattern)
#compared with HOMA-IR 37.6, Genesis Pattern 16.8 (20.8 better to find out early IR.)
table_DM_girc_all

```

## Weight loss Efficacy(OB) {#p1-3}

### Figure 6. body composition/ biochem. {#p1-3fig6}

```{r}
#Efficacy: Filter high obedience (∆weight, ∆bf, ∆pbf, ∆vfa, ∆weight%, ∆bf; ∆hba1c, ∆glucose, ∆insulin, tAUC-i, Total Calorie (carb. protein. fat.)/meal & day)

```

### Table 2. Pattern Response Improvement. {#p1-3tab2}

```{r}
#Efficacy: Filter high obedience ("Pattern Improvement")? 1st single treatment record
#x-axis: baseline, y-axis: stack endpoint

```

### Figure 7. CIM weight loss strategy {#p1-3fig7}

```{r}
#(diet obedience score divided into 10 group).

```

Method: 211 portion plate (ad libitum)

<!--chapter:end:04-Publication.Rmd-->

# 亞健康改善成效(2,4,6mo)

## [^05-improvement-1]定義 Definition {#imp_def}

[^05-improvement-1]: 參考資料:

    1.  衛福部國健署成人肥胖防治實證指引
    2.  國民健康署: 高血脂防治手冊
    3.  [@wen2008]
    4.  Wang, T.D., et al. 2022 Guidelines of the Taiwan Society of Cardiology and the Taiwan Hypertension Society for the Management of Hypertension. Acta Cardiol Sin. (2022). [PMID: 35673334]

**一、肥胖標準(Obesity):**

![](https://raw.githubusercontent.com/cofit-msl/genesisclinic/main/image/ob_def_bmi.png){width="400"}

**二、代謝症候群標準(Metabolic Syndrome):**

1.  腹部肥胖(Central Obesity): 男性腰圍 ≧ 90cm、女性腰圍 ≧ 80cm。
2.  血壓(Pressure, AC): 收縮壓 ≧ 130mmHg 或 舒張壓 ≧ 85mmHg。
3.  空腹血糖(Glucose)： 檢驗值 ≧ 100 mg/dL。
4.  空腹三酸甘油酯(TG)： 檢驗值 ≧ 150 mg/dL。
5.  高密度脂蛋白膽固醇(HDL)： 男性 \< 40mg/dL、女性 \< 50mg/dL。

以上[**5項**]{.underline}，符合[**3項**]{.underline}(含)以上即可判定為代謝症候群。

**三、糖尿病/糖尿病前期(Diabetes)**

糖尿病前期(Pre-diabetes)

1.  空腹血糖(Glucose, AC)： 100-125 mg/dL
2.  餐後2hr血糖(Glucose, 2hrs PC)： 140-199 mg/dL
3.  糖化血色素(HbA1C)：5.7 - 6.4

糖尿病(Diabetes)

1.  空腹血糖(Glucose, AC)： ≥126 mg/dL
2.  餐後2hr血糖(Glucose, 2hrs PC)： ≥200 mg/dL
3.  糖化血色素(HbA1C)：≥6.5

**四、Glucose-Insulin Response Pattern/Curve (GIRC)**

![](https://raw.githubusercontent.com/jim25287/CG_report/main/image/girc_class.png){width="1200"}

**五、高血壓(Hypertension)**

1.  正常： 收縮壓(sbp) \< 120 mmHg [**和**]{.underline} 舒張壓(dbp) \< 80 mmHg
2.  血壓偏高(Elevated): 收縮壓(sbp) 120-129 mmHg [**和**]{.underline} 舒張壓(dbp) \< 80 mmHg
3.  高血壓第1期(Grade 1)： 收縮壓(sbp) 130-139 mmHg [**或者**]{.underline} 舒張壓(dbp) 80-89 mmHg
4.  高血壓第2期(Grade 2)： 收縮壓(sbp) ≥140 mmHg [**或者**]{.underline} 舒張壓(dbp) ≥90 mmHg

**六、高血脂(Hyperlipidemia)**

1.  空腹三酸甘油酯(TG)： 檢驗值 ≧ 150 mg/dL。
2.  總膽固醇(TC)： 檢驗值 ≧ 200 mg/dL。
    1.  高密度脂蛋白膽固醇(HDL)： 男性 \< 40mg/dL、女性 \< 50mg/dL。
    2.  低密度脂蛋白膽固醇(LDL)： 檢驗值 ≥ 130mg/dL。

以上[**2項**]{.underline}，符合[**第1或第2項**]{.underline}即判定為**高血脂**。

## Program: Weight Loss {#imp_ob}

### Obesity

```{r}
imp_ob_obeisty %>% plot()

```

### Metabolic Syndrome

```{r}
imp_ob_mets %>% plot()

```

### Pre-Diabetes

```{r}
imp_ob_dm %>% plot()

```

### Insulin Response Pattern

```{r}
imp_ob_ir %>% plot()

```

### Hypertension

```{r}
imp_ob_htn %>% plot()

```

### Hyperlipidemia

```{r}
imp_ob_hlp %>% plot()

```

## Program: Diabetes Control {#imp_dm}

### Obesity

```{r}
imp_dm_obeisty %>% plot()

```

### Metabolic Syndrome

```{r}
imp_dm_mets %>% plot()

```

### Pre-Diabetes

```{r}
imp_dm_dm %>% plot()

```

### Insulin Response Pattern

```{r}
imp_dm_ir %>% plot()

```

### Hypertension

```{r}
imp_dm_htn %>% plot()

```

### Hyperlipidemia

```{r}
imp_dm_hlp %>% plot()

```

<!--chapter:end:05-Improvement.Rmd-->

