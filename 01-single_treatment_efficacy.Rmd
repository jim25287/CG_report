# Efficacy - Single Treatment

```{r input rscript, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/lin_function.R")
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/00-data_preprocessing.R")
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/01.1-venns.R")
source("~/Lincoln/02.Work/04. R&D/02. HIIS_OPP/00.Gitbook/01.CG/CG_report/rscript/01.2-global_treatment.R")

```

TBD...

## Datasets (Vens Graph) {#vens_graph}

```{r}
cat("Until 2022.11.01", "\n")
plot_1
cat(" Inbody(obs.):", clinic_inbody_data_ori %>% select(id) %>% pull() %>% unique() %>% length(), "counts\n",
    "Blood(obs.):", clinic_blood_data_ori %>% select(id) %>% pull() %>% unique() %>% length(), "counts\n",
    "Genesis(obs.):", clinical_list %>% select(id) %>% pull() %>% unique() %>% length(), "counts\n",
    "Extract obs. from 初日+北秀:", Reduce(dplyr::intersect, list(clinic_inbody_data_ori %>% select(id) %>% pull() %>% unique(),
                                                 clinic_blood_data_ori %>% select(id) %>% pull() %>% unique(),
                                                 clinical_list %>% select(id) %>% pull() %>% unique())) %>% length(), "+",
    dplyr::setdiff((dplyr::intersect(clinic_inbody_data_ori %>% select(id) %>% pull() %>% unique(),
                                                 clinic_blood_data_ori %>% select(id) %>% pull() %>% unique())),
                   clinical_list %>% select(id) %>% pull() %>% unique()) %>% length(), "=",
    dplyr::intersect(clinic_inbody_data_ori %>% select(id) %>% pull() %>% unique(),
                     clinic_blood_data_ori %>% select(id) %>% pull() %>% unique()) %>% length(),"counts\n")
```

**Inclusive Criteria:**

1.  1st treatment: Ob.(Weight Loss Program)
2.  At least 2 observations (Inbody & Blood)
3.  At least 1mo interval
4.  With OGTT baseline data(i.e., no missing value)

```{r}
plot_3
cat(" Total obs.:", dplyr::intersect(clinic_inbody_data_ori %>% select(id) %>% pull() %>% unique(),
                     clinic_blood_data_ori %>% select(id) %>% pull() %>% unique()) %>% length(),"counts\n",
    "Excluded obs.:", (dplyr::intersect(clinic_inbody_data_ori %>% select(id) %>% pull() %>% unique(),
                     clinic_blood_data_ori %>% select(id) %>% pull() %>% unique()) %>% length()) - (stat_table_1st %>% filter(client_type != 1) %>% select(id) %>% pull() %>% unique() %>% length()), "counts\n",
    "Included obs.:", stat_table_1st %>% filter(client_type != 1) %>% select(id) %>% pull() %>% unique() %>% length(), "counts\n")
```

## Treatment Effectiveness(Obesity) {#single_treatment_ob}

### Population Info

**Subjects Distribution** Age & Gender分佈

```{r, results='asis'}
gvisMerge(pie_01, pie_02, horizontal = FALSE) %>% plot()
```

BMI分佈

```{r, results='asis'}
gvisMerge(pie_03, pie_04, horizontal = FALSE) %>% plot()

```

### Global Evaluation {#global_result_ob}

```{r, results='asis'}
gvisMerge(plot_stack_col_female, plot_stack_col_male, horizontal = FALSE) %>% plot()
```

```{r, results='asis'}
line_plot
```

```{r, results='asis', warning=FALSE}
corrplot(M1, 
         p.mat = M_test1$p,
         type = "lower",
         insig = "label_sig",
         sig.level = c(.001, .01, .05), pch.cex = .8, pch.col = "black",
         tl.col = "black", tl.srt = 35, tl.cex = 1.0,
         cl.ratio = 0.1,
         col = M_col(200),
         title = "[Correlation] Efficacy x Diet", 
         #c(bottom, left, top, right)
         mar = c(0,0,1,0))

```

```{r, results='asis', warning=FALSE}
corrplot(M2, 
         p.mat = M_test2$p,
         type = "lower",
         insig = "label_sig",
         sig.level = c(.001, .01, .05), pch.cex = .8, pch.col = "black",
         tl.col = "black", tl.srt = 35, tl.cex = 1.0,
         cl.ratio = 0.1,
         col = M_col(200),
         title = "[Correlation] Efficacy x Baseline",
         #c(bottom, left, top, right)
         mar = c(0,0,1,0)) 
```

### Baseline {#ob_baseline}

#### Inbody

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots[1:10], ncol = 2, labels = paste0(LETTERS[1], seq(1,10)))

```

#### Blood

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots[11:20], ncol = 2, labels = paste0(LETTERS[2], seq(1,10)))
```

### Endpoint {#ob_endpoint}

#### Inbody

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots[21:30], ncol = 2, labels = paste0(LETTERS[3], seq(1,10)))
```

#### Blood

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots[31:40], ncol = 2, labels = paste0(LETTERS[4], seq(1,10)))
```

### Diet {#ob_diet}

```{r, results='asis', fig.width= 10, fig.height=30}
plot_grid(plotlist = myplots[41:56], ncol = 2, labels = paste0(LETTERS[5], seq(1,10)))
```

### Effectiveness {#ob_effectiveness}

#### Dif.(∆)-Inbody

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots[57:66], ncol = 2, labels = paste0(LETTERS[6], seq(1,10)))
```

#### Dif.(∆)-Blood

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots[67:76], ncol = 2, labels = paste0(LETTERS[7], seq(1,10)))
```

#### Dif.(%)-Inbody

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots[84:93], ncol = 2, labels = paste0(LETTERS[8], seq(1,10)))
```

#### Dif.(%)-Blood

```{r, results='asis', fig.width= 10, fig.height=20}
plot_grid(plotlist = myplots[94:103], ncol = 2, labels = paste0(LETTERS[9], seq(1,10)))
```






















